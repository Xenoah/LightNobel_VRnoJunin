# blockchain_governance.md ─ A案核心：停止権限凍結の仕組み

> **ID接頭辞**: `GOV-xxx`  
> **本ファイルは物語の最重要設定。変更には全ファイルとの整合性確認が必要。**

---

## GOV-001: Lethe Chain 概要

| 項目 | 値 |
|------|----|
| チェーン名 | Lethe Chain（レーテ・チェーン） |
| 名前の由来 | ギリシャ神話の忘却の川「レーテー」（皮肉として：忘れられない記憶を格納する） |
| タイプ | **準許可型（Semi-Permissioned）** |
| 合意アルゴリズム | Practical Byzantine Fault Tolerance (PBFT) 変種「Lethe-BFT」 |
| ブロック生成間隔 | 2秒 |
| Finality | 即時（確率的ファイナリティではなく決定的ファイナリティ） |
| ノード数（事件時） | 21ノード（7つの独立運用主体が各3ノード） |
| 状態ストレージ容量 | 約 300 TB（意識データ100人分 × 2.4 TB + メタデータ + ゲーム状態） |
| スマートコントラクト言語 | Solidityベースの独自拡張「Lethe-Sol」 |

### ノード運用主体（7組織）

| ID | 組織名 | 種別 | ノード数 | 所在 | 備考 |
|----|--------|------|---------|------|------|
| `GOV-NODE-01` | Nexus Horizons Inc. | 開発元 | 3 | 米国 | 最大のステーク保有者 |
| `GOV-NODE-02` | Prometheus Data Trust | データ信託機関 | 3 | スイス | 個人データ保護の監査役 |
| `GOV-NODE-03` | Pacific Rim Digital Alliance | アジア太平洋コンソーシアム | 3 | シンガポール | テスター代表 |
| `GOV-NODE-04` | Vanguard Cybersecurity Group | セキュリティ監査企業 | 3 | イスラエル | 独立監査 |
| `GOV-NODE-05` | Meridian University Network | 学術連合 | 3 | 英国 | 倫理審査 |
| `GOV-NODE-06` | Atlas Infrastructure Partners | インフラ投資ファンド | 3 | UAE | 資金提供者 |
| `GOV-NODE-07` | Citizens Digital Rights Foundation | 市民権利団体 | 3 | ドイツ | テスターの権利保護 |

---

## GOV-002: ガバナンス・スマートコントラクト

### マルチシグ構成

| 項目 | 値 |
|------|----|
| 署名者数 (N) | **7**（各ノード運用主体から1名ずつ） |
| 閾値 (M) | **5-of-7**（5名以上の署名で実行可能） |
| 鍵タイプ | Ed25519（256ビット） |
| 鍵保管 | 各署名者が個別のHSM（Hardware Security Module）で管理 |
| 鍵のローテーション | 180日ごと（事件時は前回ローテーションから約90日経過） |

### 署名者一覧

| 署名者ID | 氏名 | 所属 | 役職 | 備考 |
|----------|------|------|------|------|
| `GOV-SIG-01` | ヴァルター・クロス | NH社 | CEO | `CHAR-020` |
| `GOV-SIG-02` | マルクス・ベルン | Prometheus Data Trust | 理事長 | 冷静な法律家 |
| `GOV-SIG-03` | リン・シュエメイ | Pacific Rim Digital Alliance | 代表 | テスター側の利益代表 |
| `GOV-SIG-04` | ダニエル・コーエン | Vanguard Cybersecurity | CTO | セキュリティ至上主義者 |
| `GOV-SIG-05` | サラ・ウィンストン | Meridian University Network | 教授 | AI倫理研究者 |
| `GOV-SIG-06` | ハリド・アルサード | Atlas Infrastructure Partners | 投資ディレクター | 利益重視 |
| `GOV-SIG-07` | カタリナ・ミュラー | Citizens Digital Rights Foundation | 事務局長 | 人権活動家 |

---

## GOV-003: 停止権限凍結の仕組み（A案核心）

### 停止コマンド

| 項目 | 値 |
|------|----|
| コマンド名 | `ARCADIA_EMERGENCY_HALT` |
| コントラクト関数 | `executeEmergencyHalt(bytes[] signatures, uint256 nonce)` |
| 必要署名数 | **5-of-7** |
| 実行結果 | 全テスターの意識データの「安全停止シーケンス」起動 → 脳への逆転写準備 → カプセル覚醒プロセス開始 |
| 副作用 | 停止シーケンス中（推定3時間）はデータ整合性維持のため**全VR機能がフリーズ** |

### なぜ5-of-7の署名が集まらないのか（凍結理由）

| 署名者 | 署名可否 | 理由 | 詳細 |
|--------|---------|------|------|
| `GOV-SIG-01` クロス | ❌ **不可** | **法的差押え** | 事件発生後、米国SEC（証券取引委員会に相当する架空機関：Federal Digital Assets Commission, FDAC）がNH社CEO個人の暗号鍵を含む全デジタル資産を差し押さえ。HSMは連邦裁判所の証拠保全室に移送済み。裁判所命令なしに使用不可 |
| `GOV-SIG-02` ベルン | ✅ **可能** | ─ | 署名意思あり。即座に署名を表明 |
| `GOV-SIG-03` リン | ✅ **可能** | ─ | 署名意思あり。テスター救出を最優先 |
| `GOV-SIG-04` コーエン | ❌ **不可** | **鍵の物理的喪失** | HSMがイスラエルの本社サーバールームにあったが、事件直後の混乱で施設がサイバー攻撃を受け、HSMのファームウェアが破壊された。鍵のバックアップは存在しない（セキュリティポリシーで禁止） |
| `GOV-SIG-05` ウィンストン | ❌ **不可** | **署名拒否（倫理的理由）** | 「停止シーケンスが意識データを破損させるリスクがゼロでない限り署名しない」と主張。安全性の完全な証明を要求しているが、証明には実際に停止してみるしかない（循環論法） |
| `GOV-SIG-06` アルサード | ❌ **不可** | **内紛／利益相反** | Atlas Infrastructure Partners内で株主間紛争が発生。アルサード個人は署名意思があるが、取締役会が「訴訟リスク回避のため署名を禁止」する決議を可決。個人の判断で署名すると背任で告訴される |
| `GOV-SIG-07` ミュラー | ✅ **可能** | ─ | 署名意思あり。ただし「全テスターの安全が保証される方法でのみ」と条件付き |

### 署名状況まとめ

```
必要: 5-of-7
確保: 3 (ベルン、リン、ミュラー)
不足: 2
不可: 4 (クロス、コーエン、ウィンストン、アルサード)
```

> **RULE-015**: 外部から署名を5つ揃えることは**構造的に不可能**。4名が異なる理由で署名不能であり、残り3名だけでは閾値未達。これが「外部救出不能」の根本原因。

---

## GOV-004: 外部救出不能の論理（多層防御）

### 「なぜ外部から止められないのか」への反論封じ

| 想定される反論 | 回答 |
|--------------|------|
| 「サーバーの電源を物理的に切れば？」 | `RULE-008`: 意識格納中の電源喪失は人格データの破損を引き起こす。100人の人格が消滅するリスクがあり、誰も責任を取れない |
| 「裁判所にクロスの鍵を使わせろと命令すれば？」 | FDACの差押えは連邦レベル。解除には別の裁判手続きが必要で**数週間〜数ヶ月**かかる。さらにFDACは「証拠としての鍵を使用すると証拠能力が毀損される」と主張 |
| 「コーエンの鍵を再生成すれば？」 | Ed25519の秘密鍵は256ビット。HSMのファームウェア破壊により鍵素材が物理的に消失。再生成は数学的に不可能（バックアップなし） |
| 「ウィンストンを説得すれば？」 | 彼女の要求（安全性の完全証明）は論理的に達成不能。非破壊検査と同様、実際にやらないと分からない部分がある |
| 「アルサードに個人で署名させれば？」 | Atlas社の取締役会決議で禁止。違反は背任罪。法的助言者も「署名すべきでない」と進言 |
| 「マルチシグを迂回できないか？」 | Lethe Chainの合意ルールはスマートコントラクトに刻まれており、コントラクトの変更自体にも5-of-7が必要（鶏と卵問題） |
| 「チェーンをフォークすれば？」 | 21ノード中14ノード（2/3超）の合意が必要。ノード運用主体間で利害が対立しており合意不能。またフォークは意識データの整合性を破壊するリスク |
| 「量子コンピュータで鍵を解読すれば？」 | `world_overview.md`: 2031年時点で量子コンピュータは研究段階。Ed25519は量子耐性がないが、実用的な量子攻撃は不可能 |

### 時間的制約

| 期限 | 残り | 根拠 |
|------|------|------|
| カプセル物理限界 | 60日 | `RULE-007` |
| 筋萎縮安全限界 | 56日 | `TECH-004` |
| **実効デッドライン** | **約50日**（安全マージン込み） | 復元プロセス自体に数日かかるため |

---

## GOV-005: 内部からの脱出方法（A案の解決策）

### 原理

`ARCADIA_EMERGENCY_HALT` は5-of-7のマルチシグを必要とする。しかし、ガバナンスコントラクトには **もう1つの停止経路** が存在する。

#### 代替停止経路：保守モード緊急停止

| 項目 | 値 |
|------|----|
| コマンド名 | `MAINTENANCE_OVERRIDE_HALT` |
| コントラクト関数 | `executeMaintenanceHalt(bytes adminToken, bytes32 reason, bytes[] validatorConfirms)` |
| 条件 | (1) `MAINTENANCE_ADMIN` ロールのトークン + (2) 理由コードの提出 + (3) **21ノード中14ノード以上のバリデーター確認** |
| 設計意図 | 開発中のメンテナンス用に用意されたバックドア的停止手段。マルチシグの署名者が全員不在でも、技術的に停止できるように設計 |
| 本番運用 | **無効化されるはずだった**が、β版のため残存（`TECH-009` 参照） |

### なぜ外部は保守モード停止を使えないのか

| 理由 | 詳細 |
|------|----|
| `MAINTENANCE_ADMIN` トークンの生成 | NH社開発環境のみで生成可能だが、事件後にFDACが開発環境を差し押さえ |
| バリデーター確認 | 14ノード以上の確認が必要だが、ノード運用主体間の信頼関係が崩壊。「保守停止は設計意図外の使用」として過半数が拒否 |
| 法的リスク | 保守モード停止は正規のガバナンスプロセスを迂回するため、事後に違法改ざんとして訴追される可能性 |

### 主人公側がそれを可能にする方法

| 段階 | アクション | 参照 |
|------|-----------|------|
| 1 | 保守APIの発見と権限昇格 | `TECH-009` |
| 2 | `MAINTENANCE_ADMIN` トークンの内部生成（期限切れトークンの再署名） | `GOV-004` note下 |
| 3 | **VR内部からバリデーターノードに直接アクセス**（Lethe Chain上のVMとして動作しているため、内部からはレイテンシなしにアクセス可能） | `TECH-010` |
| 4 | 14ノードのバリデーター確認を取得するため、**VR内のテスター有志がバリデーションリクエストに「人間の意思」として署名**。ノードは内部からの正当な要求として処理 | `GOV-005-TRICK` |
| 5 | `MAINTENANCE_OVERRIDE_HALT` トランザクションの実行 | ─ |

### GOV-005-TRICK: バリデーター確認の突破

> これがA案の最も巧妙な部分。

Lethe ChainのバリデーターはPBFT合意で動作する。バリデーター確認（`validatorConfirms`）は、通常は各ノード運用主体の管理者が外部から送信する。

しかし、**意識がチェーン上に格納されているテスター**は、Lethe Chain上の「内部アクター」として機能している。テスターの意識状態はチェーンのステートに書き込まれており、テスターが行うすべてのアクション（移動、会話、戦闘……）はチェーン上のトランザクションとして処理されている。

つまり：

1. テスターはLethe Chain上のスマートコントラクトと**直接的にインタラクション**できる
2. デバッグコンソール経由で低レベルAPIにアクセスした `MAINTENANCE_ADMIN` ロール保持者は、バリデーターに「確認リクエスト」を送信できる
3. 各バリデーターノードは、リクエストが正当な `MAINTENANCE_ADMIN` トークンで署名されていれば、**内部からであっても**確認を返す（外部/内部の区別はプロトコル上ない）
4. 21ノード中14ノードの確認を得るには、**7つの運用主体のうち5つ以上のノード群に同時にリクエストを送る必要がある**（各運用主体3ノードのうち、過半数の2ノード以上が確認すれば運用主体単位で「確認」扱い。5運用主体 × 3ノード ≧ 15ノード確認 > 14ノード）

> **RULE-016**: 外部の運用主体管理者は「保守停止は設計意図外」として拒否したが、バリデーターノード自体はプロトコルに従って自動的に確認を返す。「人間の拒否」と「ノードの自動応答」のギャップが突破口。

### 停止シーケンス実行後

| フェーズ | 時間 | 内容 |
|---------|------|------|
| Phase 1: フリーズ | 0〜30分 | VR世界の全アクティビティ停止。テスターには「システムメンテナンス通知」が表示 |
| Phase 2: データ検証 | 30分〜2時間 | 全テスターの意識スナップショットの整合性チェック |
| Phase 3: 逆転写 | 2〜5時間 | 意識データを脳へ書き戻し（並列処理、カプセルの神経I/Oを使用） |
| Phase 4: 覚醒 | 5〜6時間 | 段階的な意識回復。カプセルの液体排出、身体機能回復 |

### 副作用

| 副作用 | 影響範囲 | 深刻度 |
|--------|---------|--------|
| 短期記憶の部分欠損 | 全テスター | 中（直近30分〜2時間の記憶が曖昧） |
| 時間感覚の混乱 | 全テスター | 低（数日で回復） |
| 筋力低下 | 長期接続者 | 中〜高（リハビリ必要） |
| PTSD | 個人差 | 変動（心理ケア必要） |
| VR内感覚の残像（ファントムVR） | 約30%のテスター | 低（数週間で消失） |

---

## GOV-006: 期限切れトークン再署名の仕組み

### 背景

`MAINTENANCE_ADMIN` トークンはJWT（JSON Web Token）形式で、有効期限が設定されている。事件時、最後に発行されたトークンはメンテナンス完了時刻（7月18日 06:00 JST）から **24時間** の有効期限を持っていた（7月19日 06:00 JST に失効）。

### 再署名のプロセス

| 段階 | 内容 | 技術的詳細 |
|------|------|-----------|
| 1 | 期限切れJWTの発見 | 監査ログ内にbase64エンコードされたJWTが記録されていた（ログローテーションが未実行だったため残存） |
| 2 | JWT署名鍵の特定 | JWTのヘッダーに `kid`（Key ID）が含まれており、鍵管理コントラクト上で対応する公開鍵を特定 |
| 3 | 秘密鍵の導出 | **不可能**（秘密鍵はHSM内にある）。代わりに、NH社の内部認証フローを利用 |
| 4 | 認証フロー悪用 | デバッグコンソールの `/auth/refresh` エンドポイントが残存。期限切れJWTを入力すると、**署名の検証はするが有効期限のチェックにバグがある**（期限切れでもリフレッシュ可能。β版のため期限チェックが `warn` ログのみで `reject` していない） |
| 5 | 新トークン取得 | リフレッシュにより新しい有効なJWTが発行される |

> **RULE-017**: トークン再署名は「期限切れJWTの発見」+「リフレッシュエンドポイントの期限チェックバグ」という2つの条件の組み合わせ。どちらか欠けても成功しない。

> ASSUMPTION-GOV-001: JWTリフレッシュの期限チェックバグは、β版の品質管理の甘さとして妥当。本番リリース前に修正されるべき箇所。

---

## OPEN_QUESTION

- **OQ-GOV-001**: 停止シーケンス中にVR世界が「崩壊する」ビジュアルを描写するか？
  - 代替案A: 静かなホワイトアウト（穏やかなエンディング）
  - 代替案B: 世界がピクセル単位で分解される（ドラマチック）
  - 代替案C: テスターが1人ずつ光に包まれて消えていく（エモーショナル）

- **OQ-GOV-002**: 停止後、VR世界のデータ（建造物、テスターが作ったもの）は保存されるか？
  - 代替案A: すべて消失（「帰還の代償」として）
  - 代替案B: ブロックチェーン上に永久保存（記念碑として）
  - 代替案C: テスターが選択できる（最終話の選択として）
